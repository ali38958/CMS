<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>SCMS - Dashboard</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      font-family: Arial, sans-serif;
      scrollbar-width: thin;
      scroll-behavior: smooth;
      scrollbar-color: rgb(138, 119, 119) transparent;
      -webkit-overflow-scrolling: touch;
      user-select: none;
    }

    body {
      background-color: #eef2f5;
      padding-bottom: 40px;
      overflow-x: hidden;
    }

    /* Header Styles */
    header {
      width: 100vw;
      height: 60px;
      background-color: rgb(136, 28, 28);
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 0 25px;
      margin-bottom: 30px;
      position: relative;
      z-index: 10;
    }

    .nav-bar {
      width: 100vw;
      background-color: rgb(136, 28, 28);
      display: flex;
      justify-content: center;
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
      position: relative;
      z-index: 1;
    }

    .nav-container {
      width: 100%;
      max-width: 1500px;
      display: flex;
      margin-left: 90px;
    }

    .nav-item {
      padding: 15px 25px;
      color: white;
      text-decoration: none;
      font-weight: bold;
      transition: all 0.3s ease;
      position: relative;
      text-align: center;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .nav-item:hover {
      background-color: rgba(0,0,0,0.1);
    }

    .nav-item.active {
      background-color: rgba(0,0,0,0.2);
    }

    .nav-item.active::after {
      content: "";
      position: absolute;
      bottom: 0;
      left: 50%;
      transform: translateX(-50%);
      width: 60%;
      height: 3px;
      background-color: white;
    }

    .logo {
      display: flex;
      align-items: center;
      gap: 10px;
      z-index: 2;
    }

    .logo .logo-image {
      width: 130px;
      height: auto;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 5px;
      background-color: #f4f4f4;
      border-radius: 50%;
    }

    .logo .logo-image img {
      border-radius: 50%;
      width: 100%;
      height: auto;
    }

    .logo h2 {
      color: white;
      font-size: 20px;
      white-space: nowrap;
    }

    .user {
      display: flex;
      align-items: center;
      gap: 15px;
      color: white;
    }

    .user h2 {
      font-size: 16px;
      white-space: nowrap;
    }

    .logout-btn {
      background-color: white;
      color: rgb(136, 28, 28);
      border: none;
      padding: 6px 12px;
      border-radius: 4px;
      cursor: pointer;
      font-weight: bold;
      transition: background-color 0.3s;
      border: 1px solid white;
    }

    .logout-btn:hover {
      background-color: #ddd;
    }

    .logout-btn:active {
      border: 1px solid white;
      background-color: rgb(136, 28, 28);
      color: white;
    }

    .content {
      width: 95%;
      margin: 0 auto;
      padding: 20px;
      background-color: white;
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
      border-radius: 8px;
      margin-top: 20px;
    }
    
    /* Variables */
    :root {
      --primary: rgb(136, 28, 28);
      --secondary: #8c2f2f;
      --accent: #4caf50;
      --warning: #ff9800;
      --danger: #f44336;
      --light: #f8f9fa;
      --dark: #212529;
      --gray: #6c757d;
      --card-bg: rgba(255, 255, 255, 0.95);
      --nav-bg: rgba(255, 255, 255, 0.85);
      --nav-active: rgba(136, 28, 28, 0.15);
      --nav-hover: rgba(136, 28, 28, 0.08);
      --success: #4caf50;
    }
    
    /* Dashboard Specific Styles */
    .dashboard-header {
      display: flex;
      align-items: center;
      margin-bottom: 25px;
      padding-bottom: 15px;
      border-bottom: 1px solid rgba(0,0,0,0.1);
    }

    .dashboard-header i {
      font-size: 28px;
      color: var(--primary);
      margin-right: 15px;
    }

    .dashboard-header h1 {
      font-size: 28px;
      color: var(--dark);
      font-weight: 700;
    }

    .stats-buttons {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 20px;
      margin-bottom: 30px;
    }

    .stat-button {
      background: var(--card-bg);
      border-radius: 12px;
      padding: 20px;
      box-shadow: 0 5px 15px rgba(0,0,0,0.05);
      display: flex;
      flex-direction: column;
      align-items: center;
      transition: transform 0.3s, box-shadow 0.3s;
      cursor: pointer;
    }

    .stat-button:hover {
      transform: translateY(-5px);
      box-shadow: 0 8px 20px rgba(0,0,0,0.1);
    }

    .stat-icon {
      width: 50px;
      height: 50px;
      background-color: var(--primary);
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      margin-bottom: 15px;
    }

    .stat-icon i {
      color: white;
      font-size: 20px;
    }

    .stat-title {
      font-size: 16px;
      color: var(--gray);
      margin-bottom: 5px;
    }

    .stat-value {
      font-size: 24px;
      font-weight: 700;
      color: var(--primary);
    }

    .dashboard-panel {
      display: grid;
      grid-template-columns: 2fr 1fr 1.5fr;
      gap: 25px;
      margin-bottom: 30px;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.15);
    }

    .panel-section {
      background: var(--card-bg);
      border-radius: 12px;
      padding: 10px;
    }

    .panel-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 20px;
      padding-bottom: 10px;
      border-bottom: 1px solid rgba(0,0,0,0.1);
    }

    .panel-title {
      font-size: 18px;
      font-weight: 600;
      color: var(--dark);
    }

    .chart-container {
      width: 100%;
      height: 280px;
      position: relative;
    }

    .legend {
      display: flex;
      gap: 15px;
      margin-top: 15px;
      flex-wrap: wrap;
    }

    .legend-item {
      display: flex;
      align-items: center;
      gap: 5px;
      font-size: 12px;
      cursor: pointer;
      padding: 4px 8px;
      border-radius: 4px;
      transition: background-color 0.2s;
    }

    .legend-item:hover {
      background-color: #f5f5f5;
    }

    .legend-item.active {
      background-color: #e9ecef;
    }

    .legend-color {
      width: 12px;
      height: 12px;
      border-radius: 3px;
    }

    .dropdown-menu {
      position: relative;
    }

    .dropdown-toggle {
      background: none;
      border: none;
      cursor: pointer;
      font-size: 18px;
      color: var(--gray);
    }

    .dropdown-content {
      display: none;
      position: absolute;
      right: 0;
      top: 100%;
      background: white;
      box-shadow: 0 5px 15px rgba(0,0,0,0.1);
      border-radius: 8px;
      z-index: 10;
      min-width: 150px;
    }

    .dropdown-content a {
      display: block;
      padding: 10px 15px;
      text-decoration: none;
      color: var(--dark);
      font-size: 14px;
    }

    .dropdown-content a:hover {
      background: #f5f5f5;
    }

    .dropdown-menu:hover .dropdown-content {
      display: block;
    }

    .stats-list {
      display: flex;
      flex-direction: column;
      gap: 50px;
    }

    .stat-item {
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .stat-item-icon {
      width: 30px;
      height: 30px;
      background-color: ;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .stat-item-icon i {
      color: var(--primary);
      font-size: 14px;
    }

    .stat-item-content {
      flex: 1;
    }

    .stat-item-title {
      font-size: 14px;
      color: var(--dark);
      margin-bottom: 2px;
    }
    .stat-item-icon img {
      width: 30px;   /* adjust as needed */
      height: 30px;  /* adjust as needed */
      object-fit: contain;
    }

    .stat-item-value {
      font-size: 16px;
      font-weight: 600;
      color: black;
    }

    .info-tooltip {
      position: relative;
      display: inline-block;
      margin-left: 5px;
    }

    .info-tooltip i {
      color: var(--gray);
      font-size: 14px;
      cursor: pointer;
    }

    .tooltip-content {
      display: none;
      position: absolute;
      bottom: 100%;
      left: 50%;
      transform: translateX(-50%);
      background: var(--dark);
      color: white;
      padding: 10px;
      border-radius: 5px;
      font-size: 12px;
      width: 200px;
      z-index: 100;
      text-align: left;
    }

    .info-tooltip:hover .tooltip-content {
      display: block;
    }

    .chart-navigation {
      display: flex;
      justify-content: center;
      gap: 10px;
      margin-bottom: 15px;
    }

    .nav-btn {
      padding: 8px 16px;
      border-radius: 20px;
      background: #f5f5f5;
      border: none;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      font-weight: 600;
    }

    .nav-btn:hover {
      background: #e5e5e5;
    }

    .nav-btn.active {
      background: var(--primary);
      color: white;
    }

    .trends-panel {
      display: grid;
      grid-template-columns: 1fr 2fr;
      gap: 25px;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.15);
    }

    .filters-container {
      display: flex;
      flex-direction: column;
      gap: 15px;
    }

    .filter-group {
      display: flex;
      flex-direction: column;
      gap: 8px;
    }

    .filter-group label {
      font-size: 14px;
      font-weight: 600;
      color: var(--dark);
    }

    .filter-select {
      padding: 10px 12px;
      border-radius: 8px;
      border: 1px solid rgba(0,0,0,0.1);
      background: rgba(248, 249, 250, 0.5);
      font-size: 14px;
    }

    /* Chart Styles */
    .bar-chart {
      display: flex;
      align-items: flex-end;
      height: 200px;
      gap: 8px;
      padding: 0 10px;
      justify-content: space-around;
      margin-top: 20px;
    }

    .bar-container {
      display: flex;
      flex-direction: column;
      align-items: center;
      height: 100%;
      width: 30px;
      position: relative;
    }

    .bar-group {
      display: flex;
      align-items: flex-end;
      height: 100%;
      width: 100%;
      gap: 2px;
    }

    .bar {
      width: 100%;
      border-radius: 3px 3px 0 0;
      position: relative;
      transition: opacity 0.3s;
      cursor: pointer;
      box-shadow: 0 3px 6px rgba(0, 0, 0, 0.15);
      
    }

    .bar:hover {
      opacity: 0.8;
      transform: translateY(-2px); /* little lift on hover */
    }

    .bar-label {
      position: absolute;
      bottom: -25px;
      left: 50%;
      transform: translateX(-50%);
      font-size: 10px;
      white-space: nowrap;
    }

    .pie-chart-container {
      position: relative;
      width: 100%;
      height: 100%;
      margin: 0 auto;
    }
    #nature-pie-container {
      width: 450px;   /* increase this */
      height: 450px;  /* increase this */
    }
    .pie-chart {
      width: 100%;
      height: 100%;
      position: relative;
      overflow: hidden;
    }

    .pie-segment {
      position: absolute;
      width: 100%;
      height: 100%;
      clip-path: polygon(50% 50%, 50% 0%, 100% 0%, 100% 100%, 50% 100%);
      transform-origin: center;
      border: 2px solid white;
      transition: all 0.3s ease;
      cursor: pointer;
    }

    .pie-segment:hover {
      opacity: 0.9;
      transform: scale(1.02);
      z-index: 2;
    }

    .pie-segment.highlighted {
      transform: scale(1.05);
      z-index: 3;
      filter: brightness(1.2);
    }

    .chart-tooltip {
      position: absolute;
      background: rgba(0, 0, 0, 0.8);
      color: white;
      padding: 8px 12px;
      border-radius: 4px;
      font-size: 12px;
      pointer-events: none;
      opacity: 0;
      transition: opacity 0.3s;
      z-index: 100;
    }

    .trend-filter-buttons {
      display: flex;
      gap: 10px;
      margin-bottom: 15px;
      flex-wrap: wrap;
    }

    .filter-btn {
      padding: 6px 12px;
      border-radius: 20px;
      border: 1px solid #ddd;
      background: white;
      cursor: pointer;
      font-size: 12px;
      display: flex;
      align-items: center;
      gap: 5px;
      transition: all 0.3s;
    }
    
    .filter-btn.active {
      color: white;
    }
    .pending{
      background:   #e74c3c;
      border-color: #e74c3c;
      color: white;
     
    }
    .in-progress{
      background:   #f39c12;
      border-color: #f39c12;
      color: white;
      
    }
    .completed{
      background:   #2ecc71;
      border-color: #2ecc71;
      color: white;
    }
    
    /* Axis labels */
    .chart-with-axes {
      display: flex;
      flex-direction: column;
      height: 250px;
      padding-left: 30px;
      padding-bottom: 30px;
      position: relative;
    }

    .y-axis {
      position: absolute;
      left: 0;
      top: 0;
      height: 100%;
      width: 30px;
      display: flex;
      flex-direction: column;
      justify-content: space-between;
      align-items: flex-end;
      padding: 10px 5px 30px 0;
      font-size: 10px;
      color: var(--gray);
    }

    .x-axis {
      display: flex;
      justify-content: space-around;
      padding-top: 5px;
      font-size: 10px;
      color: var(--gray);
      height: 30px;
    }

    .chart-area {
      flex: 1;
      position: relative;
    }

    /* Find button */
    .find-btn {
      background: var(--primary);
      color: white;
      border: none;
      padding: 10px 15px;
      border-radius: 8px;
      cursor: pointer;
      font-weight: 600;
      display: flex;
      align-items: center;
      gap: 5px;
      transition: background 0.3s;
      margin-top: 10px;
    }

    .find-btn:hover {
      background: var(--secondary);
    }

    /* Pie chart wrapper */
    .pie-wrapper {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
    }

    /* Category buttons */
    .category-buttons {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      margin-top: 15px;
      justify-content: center;
      max-height: 120px;
      overflow-y: auto;
      padding: 5px;
    }

    .category-btn {
      padding: 6px 10px;
      border-radius: 15px;
      border: none;
      font-size: 11px;
      cursor: pointer;
      display: flex;
      align-items: center;
      gap: 5px;
      transition: all 0.3s;
      white-space: nowrap;
    }

    .category-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 3px 6px rgba(0,0,0,0.16);
    }

    .category-btn.active {
      box-shadow: 0 0 0 2px white, 0 0 0 4px currentColor;
      font-weight: bold;
    }

    /* Modal Styles */
    .modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0, 0, 0, 0.5);
      z-index: 1000;
      justify-content: center;
      align-items: center;
    }

    .modal-content {
      background-color: white;
      padding: 20px;
      border-radius: 8px;
      max-width: 500px;
      width: 90%;
      max-height: 80vh;
      overflow-y: auto;
    }

    .modal-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 15px;
      padding-bottom: 10px;
      border-bottom: 1px solid #eee;
    }

    .modal-title {
      font-size: 18px;
      font-weight: bold;
      color: var(--primary);
    }

    .close-modal {
      background: none;
      border: none;
      font-size: 24px;
      cursor: pointer;
      color: var(--gray);
    }

    .modal-list {
      list-style-type: none;
    }

    .modal-list li {
      padding: 8px 0;
      border-bottom: 1px solid #eee;
    }

    .modal-list li:last-child {
      border-bottom: none;
    }

    /* Responsive Styles */
    @media (max-width: 1200px) {
      .dashboard-panel {
        grid-template-columns: 1fr 1fr;
      }
      
      .panel-section:nth-child(3) {
        grid-column: span 2;
      }
    }

    @media (max-width: 992px) {
      .dashboard-panel {
        grid-template-columns: 1fr;
      }
      
      .panel-section:nth-child(3) {
        grid-column: 1;
      }
      
      .trends-panel {
        grid-template-columns: 1fr;
      }
      
      .pie-chart-container {
        width: 180px;
        height: 180px;
      }
    }

    @media (max-width: 768px) {
      .stats-buttons {
        grid-template-columns: 1fr;
      }
      
      .trend-filter-buttons {
        flex-wrap: wrap;
      }
      
      .nav-container {
        margin-left: 0;
        justify-content: center;
      }
      
      .pie-chart-container {
        width: 150px;
        height: 150px;
      }
      
      .category-buttons {
        gap: 6px;
      }
      
      .category-btn {
        font-size: 10px;
        padding: 4px 8px;
      }
    }

    @media (max-width: 576px) {
      .dashboard-header h1 {
        font-size: 22px;
      }
      
      .panel-title {
        font-size: 16px;
      }
      
      .pie-chart-container {
        width: 130px;
        height: 130px;
      }
      
      .category-buttons {
        max-height: 100px;
      }
    }
  </style>
</head>
<body>
  <!-- Notification Container -->
  <div class="notification-area" id="notification-area"></div>

  <!-- Modal for displaying lists -->
  <div class="modal" id="list-modal">
    <div class="modal-content">
      <div class="modal-header">
        <h3 class="modal-title" id="modal-title">Details</h3>
        <button class="close-modal" id="close-modal">&times;</button>
      </div>
      <ul class="modal-list" id="modal-list"></ul>
    </div>
  </div>

  <header>
    <div class="logo">
      <div class="logo-image">
        <img src="logo.jpg" alt="logo image">
      </div>
      <h2>MES CMS</h2>
    </div>

    <div class="user">
      <h2 id="user-id">Unknown</h2>
      <button class="logout-btn" id="logout-btn">Logout</button>
    </div>
  </header>

  <div class="nav-bar">
    <div class="nav-container">
      <a href="dashboard.html" class="nav-item active">
        <i class="fas fa-house"></i>
        Dashboard
      </a>
      <a href="launch-complaints.html" class="nav-item">
        <i class="fas fa-ticket-alt"></i>
        Complaints
      </a>
      <a href="all-users.html" class="nav-item">
        <i class="fas fa-users"></i>
        Users
      </a>
      <a href="complaints-report.html" class="nav-item">
        <i class="fas fa-file-alt"></i>
        Reporting
      </a>
      <a href="admin-panel.html" class="nav-item">
        <i class="fas fa-cog"></i>
        Admin
      </a>
    </div>
  </div>

  <div class="content">
    <!-- Dashboard Header -->
    <div class="dashboard-header">
      <i class="fas fa-house"></i>
      <h1>Complaints Statistics</h1>
    </div>

    <!-- Stats Buttons -->
    <div class="stats-buttons">
      <div class="stat-button">
        <div class="stat-icon">
          <i class="fas fa-chart-bar"></i>
        </div>
        <div class="stat-title">Total</div>
        <div class="stat-value">1,248</div>
      </div>
      
      <div class="stat-button">
        <div class="stat-icon">
          <i class="fas fa-exclamation-circle"></i>
        </div>
        <div class="stat-title">Un-Assigned</div>
        <div class="stat-value">87</div>
      </div>
      
      <div class="stat-button">
        <div class="stat-icon">
          <i class="fas fa-spinner"></i>
        </div>
        <div class="stat-title">In-Progress</div>
        <div class="stat-value">342</div>
      </div>
      
      <div class="stat-button">
        <div class="stat-icon">
          <i class="fas fa-check-circle"></i>
        </div>
        <div class="stat-title">Completed</div>
        <div class="stat-value">819</div>
      </div>
    </div>

    <!-- First Panel -->
    <div class="dashboard-panel">
      <!-- Left: Bar Chart -->
      <div class="panel-section">
        <div class="panel-header">
          <div class="panel-title">Monthly Complaints Status</div>
          <div class="dropdown-menu">
            <button class="dropdown-toggle">
              <i class="fas fa-ellipsis-v"></i>
            </button>
            <div class="dropdown-content">
              <a href="#"><i class="fas fa-download"></i> Download SVG</a>
              <a href="#"><i class="fas fa-download"></i> Download PNG</a>
              <a href="#"><i class="fas fa-download"></i> Download CSV</a>
            </div>
          </div>
        </div>
        
        <div class="trend-filter-buttons">
          <button class="filter-btn active pending" data-category="pending">
            <i class="fas fa-exclamation-circle"></i> Pending
          </button>
          <button class="filter-btn active in-progress" data-category="inprogress">
            <i class="fas fa-spinner"></i> InProgress
          </button>
          <button class="filter-btn active completed" data-category="completed">
            <i class="fas fa-check-circle"></i> Completed
          </button>
        </div>
        
        <div class="chart-with-axes">
          <div class="y-axis">
            <span>100</span>
            <span>75</span>
            <span>50</span>
            <span>25</span>
            <span>0</span>
          </div>
          <div class="chart-area">
            <div class="bar-chart" id="monthly-chart"></div>
          </div>
          <div class="x-axis">
            <span>Jan</span>
            <span>Feb</span>
            <span>Mar</span>
            <span>Apr</span>
            <span>May</span>
            <span>Jun</span>
            <span>Jul</span>
            <span>Aug</span>
            <span>Sep</span>
            <span>Oct</span>
            <span>Nov</span>
            <span>Dec</span>
          </div>
        </div>
      </div>
      
      <!-- Middle: Current Stats -->
      <div class="panel-section">
        <div class="panel-header">
          <div class="panel-title">Current Stats</div>
        </div>
        
        <div class="stats-list">
          <div class="stat-item">
  <div class="stat-item-icon">
    <img src="../imgi_4_area.svg" alt="Colonies">
  </div>
  <div class="stat-item-content">
    <div class="stat-item-title">Colonies</div>
    <div class="stat-item-value">12</div>
  </div>
  <div class="info-tooltip" data-type="colonies">
    <i class="fas fa-question-circle"></i>
    <div class="tooltip-content">
      Total Colonies: Click to see the list
    </div>
  </div>
</div>

<div class="stat-item">
  <div class="stat-item-icon">
    <img src="../imgi_5_customer.svg" alt="Customers">
  </div>
  <div class="stat-item-content">
    <div class="stat-item-title">Customers</div>
    <div class="stat-item-value">1,842</div>
  </div>
  <div class="info-tooltip" data-type="customers">
    <i class="fas fa-question-circle"></i>
    <div class="tooltip-content">
      Total Customers: Click to see the list
    </div>
  </div>
</div>

<div class="stat-item">
  <div class="stat-item-icon">
    <img src="/imgi_6_building.svg" alt="Apartments">
  </div>
  <div class="stat-item-content">
    <div class="stat-item-title">Apartments</div>
    <div class="stat-item-value">2,576</div>
  </div>
  <div class="info-tooltip" data-type="apartments">
    <i class="fas fa-question-circle"></i>
    <div class="tooltip-content">
      Total Apartments: Click to see the list
    </div>
  </div>
</div>

<div class="stat-item">
  <div class="stat-item-icon">
    <img src="../imgi_7_staff.svg" alt="Staff/Skillman">
  </div>
  <div class="stat-item-content">
    <div class="stat-item-title">Staff/Skillman</div>
    <div class="stat-item-value">48</div>
  </div>
  <div class="info-tooltip" data-type="staff">
    <i class="fas fa-question-circle"></i>
    <div class="tooltip-content">
      Total Staff/Skillman: Click to see the list
    </div>
  </div>
</div>

        </div>
      </div>
      
      <!-- Right: Pie Charts -->
      <div class="panel-section">
        <div class="chart-navigation">
          <button class="nav-btn active" id="category-btn">Categories</button>
          <button class="nav-btn" id="nature-btn">Nature</button>
        </div>
        
        <div class="pie-wrapper">
          <div id="pie-chart-1">
            <div class="panel-header">
              <div class="panel-title">Category Wise Complaints Ratio</div>
            </div>
            <div class="pie-chart-container" id="category-pie-container">
              <canvas class="pie-chart" id="category-pie"></canvas>
            </div>
            <div class="category-buttons" id="category-buttons"></div>
          </div>
          
          <div id="pie-chart-2" style="display: none;">
            <div class="panel-header">
              <div class="panel-title">Nature Wise Complaints Ratio</div>
            </div>
            <div class="pie-chart-container" id="nature-pie-container">
              <canvas class="pie-chart" id="nature-pie"></canvas>
            </div>
            <div class="category-buttons" id="nature-buttons"></div>
          </div>
        </div>
      </div>

    </div>

    <!-- Trends Panel -->
    <div class="trends-panel">
      <!-- Filters -->
      <div class="panel-section">
        <div class="panel-header">
          <div class="panel-title">Trends Filters</div>
          <div class="dropdown-menu">
            <button class="dropdown-toggle">
              <i class="fas fa-ellipsis-v"></i>
            </button>
            <div class="dropdown-content">
              <a href="#"><i class="fas fa-download"></i> Download SVG</a>
              <a href="#"><i class="fas fa-download"></i> Download PNG</a>
              <a href="#"><i class="fas fa-download"></i> Download CSV</a>
            </div>
          </div>
        </div>
        
        <div class="filters-container">
          <div class="filter-group">
            <label for="trend-type">Trend Type</label>
            <select class="filter-select" id="trend-type">
              <option>Complaints</option>
            </select>
          </div>
          
          <div class="filter-group">
            <label for="colony">Colony</label>
            <select class="filter-select" id="colony">
              <option>Ch Afzal</option>
              <option>Majid Shaheed</option>
              <option>Tanveer Naqvi</option>
              <option>Israr Ghuman</option>
              <option>Rana Ayaz Ahmed</option>
              <option>Hamid Javeed</option>
              <option>Rana Ayaz</option>
              <option>Non - Resdl</option>
              <option>Khan pur Scheme</option>
              <option>Shabbir Shah</option>
              <option>Choudary Afzaal</option>
            </select>
          </div>
          
          <div class="filter-group">
            <label for="category">Category</label>
            <select class="filter-select" id="category">
              <option>Plumbing</option>
              <option>Electrical External Svcs</option>
              <option>Wood Work</option>
              <option>Mason Work</option>
              <option>Distemper/Paint Work</option>
              <option>Welding Work</option>
              <option>Curtain Work</option>
              <option>Aluminium</option>
              <option>Seepage/Leakage</option>
              <option>Glazier</option>
              <option>Sanitary Worker</option>
              <option>Electrical</option>
              <option>Water Supply</option>
              <option>Sui Gas</option>
              <option>Geyser</option>
              <option>Cooking Range/Hub Stove</option>
              <option>Gas External Svcs</option>
              <option>P/F External Svcs</option>
              <option>Pressure Motor</option>
              <option>Gas/Water Pressure</span>
              <option>Lift Operating</option>
              <option>Performa Work</option>
              <option>Labour External Svcs</option>
              <option>AC (Air Conditioner)</option>
              <option>POLISHIR</option>
              <option>Wood Work F&S</option>
            </select>
          </div>

          <button class="find-btn" id="find-btn">
            <i class="fas fa-search"></i> Find
          </button>
        </div>
      </div>
      
      <!-- Chart -->
      <div class="panel-section">
        <div class="panel-header">
          <div class="panel-title">Complaints Trends</div>
        </div>
        
        <div class="trend-filter-buttons">
          <button class="filter-btn active completed" data-trend="completed" id="completed">
            <i class="fas fa-check-circle"></i> Complete
          </button>
          <button class="filter-btn active in-progress" data-trend="inprogress" id="in-progress">
            <i class="fas fa-spinner"></i> InProgress
          </button>
          <button class="filter-btn active pending" data-trend="pending" id="pending">
            <i class="fas fa-exclamation-circle"></i> Pending
          </button>
        </div>
        
        <div class="chart-with-axes">
          <div class="y-axis">
            <span>40</span>
            <span>30</span>
            <span>20</span>
            <span>10</span>
            <span>0</span>
          </div>
          <div class="chart-area">
            <div class="bar-chart" id="trends-chart"></div>
          </div>
          <div class="x-axis">
            <span>Jan</span>
            <span>Feb</span>
            <span>Mar</span>
            <span>Apr</span>
            <span>May</span>
            <span>Jun</span>
            <span>Jul</span>
            <span>Aug</span>
            <span>Sep</span>
            <span>Oct</span>
            <span>Nov</span>
            <span>Dec</span>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="chart-tooltip" id="chart-tooltip"></div>

  <script>
    // Dummy data for charts
    const monthlyData = {
      months: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'],
      pending: [45, 52, 38, 60, 48, 55, 62, 58, 50, 65, 70, 75],
      inprogress: [30, 35, 40, 32, 38, 42, 45, 50, 48, 52, 55, 60],
      completed: [25, 30, 35, 40, 45, 38, 42, 48, 52, 55, 60, 65]
    };

    const categoryData = [
      { name: 'E & M I', value: 20, color: '#FF6384' },
      { name: 'E & M II', value: 15, color: '#36A2EB' },
      { name: 'B & R I', value: 25, color: '#FFCE56' },
      { name: 'B & R II', value: 18, color: '#4BC0C0' },
      { name: 'B & R III', value: 22, color: '#9966FF' }
    ];

    const natureData = [
      { name: 'Plumbing', value: 4, color: '#FF6384' },
      { name: 'Electrical External Svcs', value: 3, color: '#36A2EB' },
      { name: 'Wood Work', value: 4, color: '#FFCE56' },
      { name: 'Mason Work', value: 3, color: '#4BC0C0' },
      { name: 'Distemper/Paint Work', value: 3, color: '#9966FF' },
      { name: 'Welding Work', value: 2, color: '#FF9F40' },
      { name: 'Curtain Work', value: 2, color: '#FF6384' },
      { name: 'Aluminium', value: 2, color: '#36A2EB' },
      { name: 'Seepage/Leakage', value: 3, color: '#FFCE56' },
      { name: 'Glazier', value: 2, color: '#4BC0C0' },
      { name: 'Sanitary Worker', value: 3, color: '#9966FF' },
      { name: 'Electrical', value: 4, color: '#FF9F40' },
      { name: 'Water Supply', value: 3, color: '#FF6384' },
      { name: 'Sui Gas', value: 2, color: '#36A2EB' },
      { name: 'Geyser', value: 3, color: '#FFCE56' },
      { name: 'Cooking Range/Hub Stove', value: 2, color: '#4BC0C0' },
      { name: 'Gas External Svcs', value: 2, color: '#9966FF' },
      { name: 'P/F External Svcs', value: 2, color: '#FF9F40' },
      { name: 'Pressure Motor', value: 2, color: '#FF6384' },
      { name: 'Gas/Water Pressure', value: 2, color: '#36A2EB' },
      { name: 'Lift Operating', value: 2, color: '#FFCE56' },
      { name: 'Performa Work', value: 2, color: '#4BC0C0' },
      { name: 'Labour External Svcs', value: 3, color: '#9966FF' },
      { name: 'AC (Air Conditioner)', value: 3, color: '#FF9F40' },
      { name: 'POLISHIR', value: 2, color: '#FF6384' },
      { name: 'Wood Work F&S', value: 3, color: '#36A2EB' }
    ];

    const trendsData = {
      categories: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'],
      pending: [20, 25, 30, 22, 28, 32, 35, 38, 40, 42, 45, 48],
      inprogress: [15, 18, 22, 19, 24, 26, 28, 30, 32, 34, 36, 38],
      completed: [25, 30, 28, 32, 35, 38, 40, 42, 45, 48, 50, 52]
    };

    // Data for tooltips
    const coloniesList = [
      "Ch Afzal", "Majid Shaheed", "Tanveer Naqvi", "Israr Ghuman", 
      "Rana Ayaz Ahmed", "Hamid Javeed", "Rana Ayaz", "Non-Resdl", 
      "Khan pur Scheme", "Shabbir Shah", "Choudary Afzaal"
    ];
    
    const customersList = [
      "Customer 1", "Customer 2", "Customer 3", "Customer 4", 
      "Customer 5", "Customer 6", "Customer 7", "Customer 8"
    ];
    
    const apartmentsList = [
      "Apartment 1", "Apartment 2", "Apartment 3", "Apartment 4", 
      "Apartment 5", "Apartment 6", "Apartment 7", "Apartment 8"
    ];
    
    const staffList = [
      "Staff 1", "Staff 2", "Staff 3", "Staff 4", 
      "Staff 5", "Staff 6", "Staff 7", "Staff 8"
    ];

    // Initialize charts
    document.addEventListener('DOMContentLoaded', function() {
      // Set user ID
      const userId = localStorage.getItem('UserId') || 'Unknown';
      document.getElementById("user-id").textContent = userId;
      
      // Render charts
      renderMonthlyChart();
      renderCategoryPieChart();
      renderNaturePieChart();
      renderTrendsChart();
      
      // Setup event listeners
      setupEventListeners();
    });

    // Render monthly bar chart
    function renderMonthlyChart() {
      const chartContainer = document.getElementById('monthly-chart');
      chartContainer.innerHTML = '';
      
      const maxValue = Math.max(
        ...monthlyData.pending, 
        ...monthlyData.inprogress, 
        ...monthlyData.completed
      );
      
      const chartHeight = 200;
      
      monthlyData.months.forEach((month, i) => {
        const barContainer = document.createElement('div');
        barContainer.className = 'bar-container';
        
        const barGroup = document.createElement('div');
        barGroup.className = 'bar-group';
        
        // Create bars for each category
        if (isCategoryActive('pending')) {
          const pendingBar = createBar(
            monthlyData.pending[i], 
            maxValue, 
            chartHeight, 
            '#e74c3c',  
  
            `Pending: ${monthlyData.pending[i]}`
          );
          barGroup.appendChild(pendingBar);
        }
        
        if (isCategoryActive('inprogress')) {
          const inprogressBar = createBar(
            monthlyData.inprogress[i], 
            maxValue, 
            chartHeight, 
            '#f39c12',
            `InProgress: ${monthlyData.inprogress[i]}`
          );
          barGroup.appendChild(inprogressBar);
        }
        
        if (isCategoryActive('completed')) {
          const completedBar = createBar(
            monthlyData.completed[i], 
            maxValue, 
            chartHeight, 
            '#2ecc71', 
            `Completed: ${monthlyData.completed[i]}`
          );
          barGroup.appendChild(completedBar);
        }
        
        barContainer.appendChild(barGroup);
        
        const label = document.createElement('div');
        label.className = 'bar-label';
        label.textContent = month;
        barContainer.appendChild(label);
        
        chartContainer.appendChild(barContainer);
      });
    }

    // Create a bar element
    function createBar(value, maxValue, chartHeight, color, tooltipText) {
      const bar = document.createElement('div');
      bar.className = 'bar';
      bar.style.height = `${(value / maxValue) * chartHeight}px`;
      bar.style.backgroundColor = color;
      
      // Add tooltip
      bar.addEventListener('mousemove', (e) => {
        const tooltip = document.getElementById('chart-tooltip');
        tooltip.innerHTML = tooltipText;
        tooltip.style.opacity = '1';
        tooltip.style.left = `${e.pageX + 10}px`;
        tooltip.style.top = `${e.pageY - 30}px`;
      });
      
      bar.addEventListener('mouseout', () => {
        document.getElementById('chart-tooltip').style.opacity = '0';
      });
      
      return bar;
    }

    // Check if a category is active
    function isCategoryActive(category) {
      const filterBtn = document.querySelector(`.filter-btn[data-category="${category}"]`);
      return filterBtn && filterBtn.classList.contains('active');
    }

    // Render category pie chart
function renderCategoryPieChart() {
  const ctx = document.getElementById('category-pie').getContext('2d');
  new Chart(ctx, {
    type: 'pie',
    data: {
      labels: categoryData.map(item => item.name),
      datasets: [{
        data: categoryData.map(item => item.value),
        backgroundColor: categoryData.map(item => item.color),
      }]
    },
    options: {
      responsive: true,
      plugins: {
        legend: {
          position: 'bottom'
        },
        datalabels: {
          color: '#fff',
          font: {
            weight: 'bold',
            size: 12
          },
          anchor: 'end',   // moves label to the edge of the slice
          align: 'end',    // keeps it outside towards the arc
          offset: -45,       // adds a little spacing from the arc
          formatter: (value, context) => {
            const dataset = context.chart.data.datasets[0].data;
            const total = dataset.reduce((a, b) => a + b, 0);
            const percentage = ((value / total) * 100).toFixed(1) + "%";
            return percentage;
          }
        }
      }
    },
    plugins: [ChartDataLabels]
  });
}


    // Render nature pie chart

function renderNaturePieChart() {
  const ctx = document.getElementById('nature-pie').getContext('2d');
  new Chart(ctx, {
    type: 'pie',
    data: {
      labels: natureData.map(item => item.name),
      datasets: [{
        data: natureData.map(item => item.value),
        backgroundColor: natureData.map(item => item.color),
      }]
    },
    options: {
      responsive: true,
      plugins: {
        legend: {
          position: 'bottom'
        },
        datalabels: {
          color: '#fff',
          font: {
            weight: 'bold',
            size: 12
          },
          anchor: 'end',   // moves label to the edge of the slice
          align: 'end',    // keeps it outside towards the arc
          offset: -35,       // adds a little spacing from the arc
          formatter: (value, context) => {
            const dataset = context.chart.data.datasets[0].data;
            const total = dataset.reduce((a, b) => a + b, 0);
            const percentage = ((value / total) * 100).toFixed(1) + "%";
            return percentage;
          }
        }
      }
    },
    plugins: [ChartDataLabels]
  });
}

    // Highlight a segment in the pie chart
    function highlightSegment(segment, color) {
      // Remove highlight from all segments
      document.querySelectorAll('.pie-segment').forEach(seg => {
        seg.classList.remove('highlighted');
      });
      
      // Remove active class from all buttons
      document.querySelectorAll('.category-btn').forEach(btn => {
        btn.classList.remove('active');
      });
      
      // Highlight the selected segment
      segment.classList.add('highlighted');
      
      // Find and activate the corresponding button
      const segmentName = segment.dataset.name;
      const buttons = document.querySelectorAll('.category-btn');
      buttons.forEach(btn => {
        if (btn.textContent.includes(segmentName)) {
          btn.classList.add('active');
        }
      });
      
      // Show notification with segment info
      showNotification(`${segmentName}: ${segment.dataset.value} (${segment.dataset.percentage}%)`, 'info');
    }

    // Render trends chart
    function renderTrendsChart() {
      const chartContainer = document.getElementById('trends-chart');
      chartContainer.innerHTML = '';
      
      const maxValue = Math.max(
        ...trendsData.pending, 
        ...trendsData.inprogress, 
        ...trendsData.completed
      );
      
      const chartHeight = 200;
      
      trendsData.categories.forEach((category, i) => {
        const barContainer = document.createElement('div');
        barContainer.className = 'bar-container';
        
        const barGroup = document.createElement('div');
        barGroup.className = 'bar-group';
        
        // Create bars for each trend
        if (isTrendActive('pending')) {
          const pendingBar = createBar(
            trendsData.pending[i], 
            maxValue, 
            chartHeight, 
            '#e74c3c', 
            `Pending: ${trendsData.pending[i]}`
          );
          barGroup.appendChild(pendingBar);
        }
        
        if (isTrendActive('inprogress')) {
          const inprogressBar = createBar(
            trendsData.inprogress[i], 
            maxValue, 
            chartHeight, 
            '#f39c12', 
            `InProgress: ${trendsData.inprogress[i]}`
          );
          barGroup.appendChild(inprogressBar);
        }
        
        if (isTrendActive('completed')) {
          const completedBar = createBar(
            trendsData.completed[i], 
            maxValue, 
            chartHeight, 
            '#2ecc71', 
            `Completed: ${trendsData.completed[i]}`
          );
          barGroup.appendChild(completedBar);
        }
        
        barContainer.appendChild(barGroup);
        
        const label = document.createElement('div');
        label.className = 'bar-label';
        label.textContent = category;
        barContainer.appendChild(label);
        
        chartContainer.appendChild(barContainer);
      });
    }

    // Check if a trend is active
    function isTrendActive(trend) {
      const trendBtn = document.querySelector(`.filter-btn[data-trend="${trend}"]`);
      return trendBtn && trendBtn.classList.contains('active');
    }

    // Setup event listeners
    function setupEventListeners() {
      // Monthly chart filter buttons
      document.querySelectorAll('.filter-btn[data-category]').forEach(btn => {
        btn.addEventListener('click', () => {
          btn.classList.toggle('active');
          renderMonthlyChart();
        });
      });
      
      // Trends chart filter buttons
      document.querySelectorAll('.filter-btn[data-trend]').forEach(btn => {
        btn.addEventListener('click', () => {
          btn.classList.toggle('active');
          renderTrendsChart();
        });
      });
      
      // Pie chart navigation
      document.getElementById('category-btn').addEventListener('click', function() {
        this.classList.add('active');
        document.getElementById('nature-btn').classList.remove('active');
        navigateToPieChart(1);
      });
      
      document.getElementById('nature-btn').addEventListener('click', function() {
        this.classList.add('active');
        document.getElementById('category-btn').classList.remove('active');
        navigateToPieChart(2);
      });
      
      // Find button
      document.getElementById('find-btn').addEventListener('click', function() {
        const colony = document.getElementById('colony').value;
        const category = document.getElementById('category').value;
        
        // Simulate filtering data
        showNotification(`Showing trends for ${colony} - ${category}`, 'info');
        
        // Update trends data based on selection (simulated)
        trendsData.pending = trendsData.pending.map(() => Math.floor(Math.random() * 20) + 10);
        trendsData.inprogress = trendsData.inprogress.map(() => Math.floor(Math.random() * 20) + 15);
        trendsData.completed = trendsData.completed.map(() => Math.floor(Math.random() * 20) + 20);
        
        renderTrendsChart();
      });

      // Info tooltip click handlers
      document.querySelectorAll('.info-tooltip').forEach(tooltip => {
        tooltip.addEventListener('click', function() {
          const type = this.getAttribute('data-type');
          showModal(type);
        });
      });

      // Modal close button
      document.getElementById('close-modal').addEventListener('click', function() {
        document.getElementById('list-modal').style.display = 'none';
      });

      // Close modal when clicking outside
      window.addEventListener('click', function(event) {
        const modal = document.getElementById('list-modal');
        if (event.target === modal) {
          modal.style.display = 'none';
        }
      });
    }

    // Navigate to specific pie chart
    function navigateToPieChart(chartNumber) {
      document.getElementById('pie-chart-1').style.display = chartNumber === 1 ? 'block' : 'none';
      document.getElementById('pie-chart-2').style.display = chartNumber === 2 ? 'block' : 'none';
    }

    // Show modal with list
    function showModal(type) {
      const modal = document.getElementById('list-modal');
      const modalTitle = document.getElementById('modal-title');
      const modalList = document.getElementById('modal-list');
      
      // Clear previous list
      modalList.innerHTML = '';
      
      // Set title and list based on type
      let title = '';
      let listItems = [];
      
      switch(type) {
        case 'colonies':
          title = 'Colonies List';
          listItems = coloniesList;
          break;
        case 'customers':
          title = 'Customers List';
          listItems = customersList;
          break;
        case 'apartments':
          title = 'Apartments List';
          listItems = apartmentsList;
          break;
        case 'staff':
          title = 'Staff/Skillman List';
          listItems = staffList;
          break;
      }
      
      modalTitle.textContent = title;
      
      // Add items to the list
      listItems.forEach(item => {
        const li = document.createElement('li');
        li.textContent = item;
        modalList.appendChild(li);
      });
      
      // Show the modal
      modal.style.display = 'flex';
    }

    // Show notification
    function showNotification(message, type = 'info') {
      const notificationArea = document.getElementById('notification-area');
      
      const notification = document.createElement('div');
      notification.className = `notification ${type}`;
      notification.innerHTML = `
        <i class="fas fa-${type === 'info' ? 'info-circle' : 'check-circle'}"></i>
        ${message}
      `;
      
      notificationArea.appendChild(notification);
      
      setTimeout(() => {
        notification.style.opacity = '0';
        setTimeout(() => notification.remove(), 300);
      }, 3000);
    }
  </script>
</body>
</html>
